{"version":3,"file":"v-click-outside.umd.js","sources":["../src/v-click-outside.js","../src/index.js"],"sourcesContent":["const HANDLERS_PROPERTY = '__v-click-outside'\nconst HAS_WINDOWS = typeof window !== 'undefined'\nconst HAS_NAVIGATOR = typeof navigator !== 'undefined'\nconst IS_TOUCH =\n  HAS_WINDOWS &&\n  ('ontouchstart' in window ||\n    (HAS_NAVIGATOR && navigator.msMaxTouchPoints > 0))\nconst EVENTS = IS_TOUCH ? ['touchstart'] : ['click']\n\nfunction processDirectiveArguments(bindingValue) {\n  const isFunction = typeof bindingValue === 'function'\n  if (!isFunction && typeof bindingValue !== 'object') {\n    throw new Error(\n      'v-click-outside: Binding value must be a function or an object',\n    )\n  }\n\n  return {\n    handler: isFunction ? bindingValue : bindingValue.handler,\n    middleware: bindingValue.middleware || ((item) => item),\n    events: bindingValue.events || EVENTS,\n    isActive: !(bindingValue.isActive === false),\n  }\n}\n\nfunction onEvent({ el, event, handler, middleware }) {\n  // Note: composedPath is not supported on IE and Edge, more information here:\n  //       https://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath\n  //       In the meanwhile, we are using el.contains for those browsers, not\n  //       the ideal solution, but using IE or EDGE is not ideal either.\n  const path = event.path || (event.composedPath && event.composedPath())\n  const outsideCheck = path ? path.indexOf(el) < 0 : !el.contains(event.target)\n\n  const isClickOutside = event.target !== el && outsideCheck\n\n  if (!isClickOutside) {\n    return\n  }\n\n  if (middleware(event)) {\n    handler(event)\n  }\n}\n\nfunction bind(el, { value }) {\n  const { events, handler, middleware, isActive } = processDirectiveArguments(\n    value,\n  )\n  if (!isActive) {\n    return\n  }\n\n  el[HANDLERS_PROPERTY] = events.map((eventName) => ({\n    event: eventName,\n    handler: (event) => onEvent({ event, el, handler, middleware }),\n  }))\n\n  el[HANDLERS_PROPERTY].forEach(({ event, handler }) =>\n    setTimeout(() => {\n      // Note: More info about this implementation can be found here:\n      //       https://github.com/ndelvalle/v-click-outside/issues/137\n      if (!el[HANDLERS_PROPERTY]) {\n        return\n      }\n      document.documentElement.addEventListener(event, handler, false)\n    }, 0),\n  )\n}\n\nfunction unbind(el) {\n  const handlers = el[HANDLERS_PROPERTY] || []\n  handlers.forEach(({ event, handler }) =>\n    document.documentElement.removeEventListener(event, handler, false),\n  )\n  delete el[HANDLERS_PROPERTY]\n}\n\nfunction update(el, { value, oldValue }) {\n  if (JSON.stringify(value) === JSON.stringify(oldValue)) {\n    return\n  }\n  unbind(el)\n  bind(el, { value })\n}\n\nconst directive = {\n  bind,\n  update,\n  unbind,\n}\n\nexport default HAS_WINDOWS ? directive : {}\n","import directive from './v-click-outside'\n\nconst plugin = {\n  install(Vue) {\n    Vue.directive('click-outside', directive)\n  },\n  directive,\n}\n\nexport default plugin\n"],"names":["const","HANDLERS_PROPERTY","HAS_WINDOWS","window","HAS_NAVIGATOR","navigator","EVENTS","msMaxTouchPoints","bind","el","ref","bindingValue","isFunction","Error","handler","middleware","item","events","isActive","processDirectiveArguments","map","eventName","event","path","composedPath","outsideCheck","indexOf","contains","target","onEvent","forEach","setTimeout","document","documentElement","addEventListener","unbind","removeEventListener","JSON","stringify","value","oldValue","install","Vue","directive"],"mappings":"iLAAAA,IAAMC,EAAoB,oBACpBC,EAAgC,oBAAXC,OACrBC,EAAqC,oBAAdC,UAKvBC,EAHJJ,IACC,iBAAkBC,QAChBC,GAAiBC,UAAUE,iBAAmB,GACzB,CAAC,cAAgB,CAAC,SAqC5C,SAASC,EAAKC,EAAIC,SAnClB,SAAmCC,OAC3BC,EAAqC,mBAAjBD,MACrBC,GAAsC,iBAAjBD,QAClB,IAAIE,MACR,wEAIG,CACLC,QAASF,EAAaD,EAAeA,EAAaG,QAClDC,WAAYJ,EAAaI,qBAAgBC,UAASA,GAClDC,OAAQN,EAAaM,QAAUX,EAC/BY,YAAsC,IAA1BP,EAAaO,WAwBuBC,kDAOlDV,EAAGR,YAA4BmB,aAAKC,UAClCC,MAAOD,EACPP,iBAAUQ,UA7Bd,SAAiBZ,mDAKTa,EAAOD,EAAMC,MAASD,EAAME,cAAgBF,EAAME,eAClDC,EAAeF,EAAOA,EAAKG,QAAQjB,GAAM,GAAKA,EAAGkB,SAASL,EAAMM,QAE/CN,EAAMM,SAAWnB,GAAMgB,GAM1CV,EAAWO,IACbR,EAAQQ,GAcYO,CAAQ,OAAEP,KAAOb,UAAIK,aAASC,QAGpDN,EAAGR,GAAmB6B,iBAASpB,oCAC7BqB,sBAGOtB,EAAGR,IAGR+B,SAASC,gBAAgBC,iBAAiBZ,EAAOR,GAAS,IACzD,MAIP,SAASqB,EAAO1B,IACGA,EAAGR,IAAsB,IACjC6B,iBAASpB,UAChBsB,SAASC,gBAAgBG,uCAAoC,YAExD3B,EAAGR,GAWZD,MAMeE,EANG,MAChBM,SATF,SAAgBC,EAAIC,8BACd2B,KAAKC,UAAUC,KAAWF,KAAKC,UAAUE,KAG7CL,EAAO1B,GACPD,EAAKC,EAAI,OAAE8B,aAMXJ,GAGuC,SCzF1B,CACbM,iBAAQC,GACNA,EAAIC,UAAU,gBAAiBA,cAEjCA"}